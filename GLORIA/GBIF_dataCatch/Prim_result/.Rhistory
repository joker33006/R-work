class(order)
View(plot_b1)
ggplot(data=plot_b1,aes(bio_1,y=fac_reorder(code,order)))+
geom_boxplot()+
class(order)
fac_reorder(code,order)
ggplot(data=plot_b1,aes(bio_1,y=fct_reorder(code,order)))+
geom_boxplot()+
class(order)
ggplot(data=plot_b1,aes(bio_1,y=fct_reorder(code,order)))+
geom_boxplot()
ggplot(data=plot_b1,aes(bio_1,y=reorder(code,order)))+
geom_boxplot()
ggplot(data=plot_b1,aes(bio_1,y=reorder(code,order)))+
geom_boxplot()+
stat_summary(geom = 'text', label = groups, fun.x = max, vjust = -1)
ggplot(data=plot_b1,aes(bio_1,y=reorder(code,order)))+
geom_boxplot()+
stat_summary(geom = 'text', label = plot_b1$groups, fun.x = max, vjust = -1)
View(order_1)
order_1 <- [order(order)]
order_1 <- order_1[order(order)]
ggplot(data=plot_b1,aes(bio_1,y=reorder(code,order)))+
geom_boxplot()+
stat_summary(geom = 'text', label = order_1$groups, fun.x = max, vjust = -1)
ggplot(data=plot_b1,aes(bio_1,y=reorder(code,order)))+
geom_boxplot()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1))+
geom_boxplot()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(aes(label = groups), vjust = 1.5, colour = "white")
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(aes(label = order_1$groups), vjust = 1.5, colour = "white")
order_1$groups
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = 1.5, colour = "white")
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = 1.5)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = 6)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = 9)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = -3)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot()+
geom_text(data=order_1,aes(label = groups), vjust = -5)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), vjust = -5)
ggplot(data=plot_b1,aes(y=as.factor(reorder(code,order)),x=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), cjust = -5)
ggplot(data=plot_b1,aes(y=as.factor(reorder(code,order)),x=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE)
ggplot(data=plot_b1,aes(y=as.factor(reorder(code,order)),x=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-5)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-5)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)
plot_b1 <- plot_b1[order(order)]
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
stat_unique(code)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
axe
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
stat_unique(groups)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
axe
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
stat_unique(data=plot_b1,groups)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
axe
plot_b1 <- plot_b1[order(order)]
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(aes(label = groups),stat="unique", check_overlap = TRUE,vjust=-6)+
theme_classic()+
axe
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(aes(label = groups),stat="unique", check_overlap = TRUE,vjust=-6)+
theme_classic()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
axe
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
labs(x='species code',y='The annual average temperature')
ggsave(paste0(path,"plot_result"),width = 10,height = 5,dpi=600)
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10))+
geom_boxplot(outlier.colour=NA)+
geom_text(data=order_1,aes(label = groups), check_overlap = TRUE,vjust=-6)+
theme_classic()+
labs(x='Species code',y='The annual average temperature')
ggsave(paste0(path,"plot_result/bio_1.jpeg"),width = 10,height = 5,dpi=600)
ggsave(paste0(path,"plot_result/bio_1.jpeg"),width = 12,height = 5,dpi=600)
############################### multiple comparison of rainfall
aov12 <- aov(bio_12~code,data=rloc)
tuk <- HSD.test(aov12,"code")
order_12 <-tuk$group
order_12 <- as.data.table(cbind(order_12,rownames(order_12),c(1:length(order_12[,1]))))
library(data.table)
library(ggplot2)
library(useful)
library(multcomp)
library(multcompView)
library(agricolae)
############################### multiple comparison of rainfall
aov12 <- aov(bio_12~code,data=rloc)
tuk <- HSD.test(aov12,"code")
order_12 <-tuk$group
order_12 <- as.data.table(cbind(order_12,rownames(order_12),c(1:length(order_12[,1]))))
colnames(order_12)[3:4] <-c('code','order')
order_12 <- order_12[order(order)]
write.csv(order_12,paste0(path,'species_group_rain.csv'))
setkey(rloc,code)
setkey(order_12,code)
plot_b12 <- rloc[order_12]
plot_b12[,i.bio_12:=NULL]
plot_b12 <- plot_b12[order(order)]
ggplot(data=plot_b12,aes(x=as.factor(reorder(code,order)),y=bio_12,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x='Species code',y='Annual precipitation (mm)',fill = "group")+
geom_hline(yintercept=c(250,500,1000,2000,4000), linetype="dashed", color = "gray51")
ggsave(paste0(path,"plot_result/bio_12.jpeg"),width = 13,height = 7,dpi=600)
plot_data <- fread("E:/忍者/R-work/Git/R-work/Chao/result_and_month_fin.csv")
####################plot
library(data.table)
plot_data <- fread("E:/忍者/R-work/Git/R-work/Chao/result_and_month_fin.csv")
View(plot_data)
aov1 <- aov(temp~name,data=plot_data)
library(agricolae)
tuk <- Scheffee(aov1,"code")
tuk <- scheffe.test(aov1,"code")
order_1 <-tuk$group
View(aov1)
aov1 <- aov(temp~name,data=plot_data)
tuk <- scheffe.test(aov1,"name")
order_1 <-tuk$group
View(order_1)
plot_data[order_1]
order_1 <-tuk$group[,name:=colnames(order_1)]
order_1 <- [,name:=colnames(order_1)]
order_1[,name:=colnames(order_1)]
order_1 <-as.data.table(tuk$group)
View(order_1)
order_1[,name:=colnames(tuk$groups)]
colnames(tuk$groups)
order_1[,name:=rownames(tuk$groups)]
plot_data[order_1,on=.(name=name)]
plot_data <- plot_data[order_1,on=.(name=name)]
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()
library(ggplot2)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()
ggsave('prim_plot.jpeg',width = 10, height = 5,dpi = 600)
ggsave('prim_plot.jpeg',width = 10, height = 5,dpi = 600)
View(order_1)
ggsave('prim_plot.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()
ggsave('prim_plot.jpeg',width = 10, height = 5,dpi = 600)
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot.jpeg',width = 10, height = 5,dpi = 600)
order_1 <-as.data.table(tuk$groups)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature(°C)",y=NULL,fill='Group')+
geom_text(ase(y=groups),data=tuk$groups)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature(°C)",y=NULL,fill='Group')+
geom_text(y=groups,data=tuk$groups)
order_1 <-as.data.table(tuk$groups)
tuk$groups
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature(°C)",y=NULL,fill='Group')+
geom_text(aes(y=groups),data=tuk$groups)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature(°C)",y="",fill='Group')+
geom_text(aes(y=groups),data=tuk$groups)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature(°C)",y="",fill='Group')
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Dark2")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set3")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot(stat = "identity")+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot(stat = xmiddle)+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot(stat = 'xmiddle')+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot(stat = 'mean')+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")
name:=rownames(tuk$groups)
name <- rownames(tuk$groups)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")+
scale_y_discrete(limits=name)
name <-sort(rownames(tuk$groups))
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")+
scale_y_discrete(limits=name)
name <-sort(rownames(tuk$groups),decreasing = TRUE)
name <-sort(rownames(tuk$groups),increasing = TRUE)
name <-sort(rownames(tuk$groups),decreasing = F)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")+
scale_y_discrete(limits=name)
name <-sort(rownames(tuk$groups),decreasing = T)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")+
scale_y_discrete(limits=name)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="RdYlBu")+
scale_y_discrete(limits=name)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="BrBg")+
scale_y_discrete(limits=name)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="BrBG")+
scale_y_discrete(limits=name)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="PuBu")+
scale_y_discrete(limits=name)
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c1.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Paired")+
scale_y_discrete(limits=name)
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c2.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set2")+
scale_y_discrete(limits=name)
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c3.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set2")+
scale_y_discrete(limits=name)+
+theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set2")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c3.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set2")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
legend.text =element_text(size=12),
legend.title =  =element_text(size=14))
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Set2")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
legend.text=element_text(size=12),
legend.title=element_text(size=14))
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c3.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="GnBu")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
legend.text=element_text(size=12),
legend.title=element_text(size=14))
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c1.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Paired")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
legend.text=element_text(size=12),
legend.title=element_text(size=14))
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c2.jpeg',width = 10, height = 5,dpi = 600)
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature of flower period (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Paired")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"),
legend.text=element_text(size=12),
legend.title=element_text(size=14))
ggplot(data=plot_data,aes(x=temp/10,y=name,fill=groups))+
geom_boxplot()+
labs(x="Mean monthly temperature (°C)",y="",fill='Group')+
scale_fill_brewer(palette="Paired")+
scale_y_discrete(limits=name)+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=13,face="bold"),
legend.text=element_text(size=12),
legend.title=element_text(size=13))
ggsave('E:/忍者/R-work/Git/R-work/Chao/prim_plot_c2.jpeg',width = 10, height = 5,dpi = 600)
library(data.table)
library(ggplot2)
library(agricolae)
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
rdata <- fread(paste0(path,"species_climate.csv"))
View(rdata)
r2 <- rdata[,names(rdata[,6:24]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
rloc <- r2[,.(bio_1,bio_12,code,name)][,code:=as.factor(code)]
View(rloc)
r2 <- rdata[,names(rdata[,6:24]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
View(r2)
library(data.table)
library(rgbif)
library(ggplot2)
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
sp_p <- list.files("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/prim_result", pattern='.csv')
setwd(paste0(path,"prim_result"))
################### Starting to organize data
sp_p <- list.files("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/prim_result", pattern='.csv')
sp_n <- sub('.csv',"",sp_p)
setwd(paste0(path,"prim_result"))
my_data <- lapply(sp_p,fread)
for (i in 1:length(sp_n)){
my_data[[i]][,name:=sp_n[i]][,code:=as.numeric(i)]
}
View(my_data)
bio <- NULL
bio_tol <- NULL
for (i in 1:73){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
View(bio_tol)
bio_tol <- bio_tol[,V1:=NULL]
bio_tol[,key:=paste0(decimalLongitude,decimalLatitude)]
setkey(bio_tol,key)
bio_tol_2 <- unique(bio_tol)
View(bio_tol_2)
write.csv(bio_tol_2,"species_climate.csv")
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
rdata <- fread(paste0(path,"species_climate.csv"))
View(rdata)
library(data.table)
library(ggplot2)
library(agricolae)
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
rdata <- fread(paste0(path,"species_climate.csv"))
r2 <- rdata[,names(rdata[,7:25]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
rloc <- r2[,.(bio_1,bio_12,code,name)][,code:=as.factor(code)]
View(rloc)
r2 <- rdata[,names(rdata[,5:25]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
r2 <- rdata[,names(rdata[,5:23]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
View(r2)
names(rdata[,5:23])
rdata <- fread(paste0(path,"species_climate.csv"))
r2 <- rdata[,names(rdata[,5:23]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
View(r2)
rloc <- r2[,.(bio_1,bio_12,code,name)][,code:=as.factor(code)]
############################### multiple comparison of temp
aov1 <- aov(bio_1~code,data=rloc)
tuk <- Median.test(aov1,"code")
tuk <- with(rloc,Median.test(bio_1,code))
order_1 <-tuk$group
order_1 <- as.data.table(cbind(order_1,rownames(order_1),c(1:length(order_1[,1]))))
colnames(order_1)[3:4] <-c('code','order')
order_1 <- order_1[order(order)]
write.csv(order_1,paste0(path,'species_group_temp.csv'))
setkey(rloc,code)
setkey(order_1,code)
plot_b1 <- rloc[order_1]
plot_b1[,i.bio_1:=NULL]
plot_b1 <- plot_b1[order(order)]
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x='Species code',y='AAT (°C)',fill = "group")+
geom_hline(yintercept=c(5,8,11,17,23), linetype="dashed", color = "gray51")
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x='Species code',y='AAT (°C)',fill = "group")+
+ theme(legend.position = "none")+
geom_hline(yintercept=c(5,8,11,17,23), linetype="dashed", color = "gray51")
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x='Species code',y='AAT (°C)',fill = "group")+
theme(legend.position = "none")+
geom_hline(yintercept=c(5,8,11,17,23), linetype="dashed", color = "gray51")
ggsave(paste0(path,"plot_result/bio_1_2.jpeg"),width = 12,height = 5,dpi=600)
###########################
dt <- bio_tol[,.SD,.SDcols=patterns('bio')]
bio_tol[,names(dt):=lapply(.SD,as.numeric),.SDcols=patterns('bio')]
dt2 <- bio_tol[,quantile(.(bio_1,bio_12)),by=name]
bio_tol[,names(dt):=lapply(.SD,as.numeric),.SDcols=patterns('bio')]
###########################
dt <- bio_tol_2[,.SD,.SDcols=patterns('bio')]
bio_tol_2[,names(dt):=lapply(.SD,as.numeric),.SDcols=patterns('bio')]
dt2 <- bio_tol_2[,quantile(.(bio_1,bio_12)),by=name]
dt2 <- bio_tol_2[,quantile(.(bio_1,bio_12)),by=code]
View(bio_tol_2)
dt2 <- bio_tol_2[order(code)][,quantile(.(bio_1,bio_12)),by=code]
dt2 <- bio_tol_2[order(code)]
View(dt2)
dt2 <- bio_tol_2[order(code)][,quantile(.(bio_1,bio_12)),by=as.factor(code)]
dt2 <- bio_tol_2[order(code)][,quantile(bio_1),by=as.factor(code)]
dt2[,q:=as.factor(rep(1:5,times=73))]
dt2 <- dcast(dt2,name~q,value.var = 'V1')
dt2 <- dcast(dt2,code~q,value.var = 'V1')
View(dt2)
dt2 <- bio_tol_2[order(code)][,quantile(bio_1),by=code]
dt2[,q:=as.factor(rep(1:5,times=73))]
dt2 <- dcast(dt2,code~q,value.var = 'V1')
colnames(dt2)[2:6] <- paste0("bio1_",colnames(dt2)[2:6])
write.csv(dt2,"E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/bio_12_qun.csv")
write.csv(dt2,"E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/bio_1_qun.csv")
###########################
dt <- bio_tol_2[,.SD,.SDcols=patterns('bio')]
bio_tol_2[,names(dt):=lapply(.SD,as.numeric),.SDcols=patterns('bio')]
dt2 <- bio_tol_2[order(code)][,quantile(bio_12),by=code]
dt2[,q:=as.factor(rep(1:5,times=73))]
dt2 <- dcast(dt2,code~q,value.var = 'V1')
colnames(dt2)[2:6] <- paste0("bio12_",colnames(dt2)[2:6])
write.csv(dt2,"E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/bio_12_qun.csv")
