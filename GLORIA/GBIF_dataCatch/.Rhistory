team_Name <- remDr$findElement(using = "id",value ="ContentPlaceHolder1_teams_name")
team_Name$sendKeysToElement("中興森林",key="enter")
team_Name$sendKeysToElement(list("中興森林",key="enter"))
selt <- remDr$findElement(using = "id",value = "ContentPlaceHolder1_climblinemain")
selt[[4]]$clickElement()
selt[4]$clickElement()
selt
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "CSS select",value = #ContentPlaceHolder1_climbline > option:nth-child(4))
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
selt2$clickElement()
### days
selt3 <- remDr$findElement(using="css selector",value =
"#ContentPlaceHolder1_sumday > option:nth-child(6)")
selt3$clickElement()
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/option value=109-05-30"
)
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/option")
selt3$opition
selt3$option
selt3$value
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/")
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/")
### date
selt4 <- remDr$findElement(using="xpath",value =
"//*[@id='ContentPlaceHolder1_applystart']")
selt4$value
opts <- selt4$selectTag()
selt4$value
selt4$value$value
class(selt4$value$value)
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
remDr$open()
remDr$navigate("https://translate.google.com.tw/?hl=zh-TW")
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("我的頭好痛"))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(10)
}
cn$clearElement()
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.5)
}
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.5)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.1)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.2)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("蘇昱好帥 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
remDr$open()
remDr$navigate("https://translate.google.com.tw/?hl=zh-TW")
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("方丈為人很小心眼的"))
for (i in 1:5){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(10)
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
library(data.table)
library(rgbif)
sp_p <- list.files("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/prim_result", pattern='.csv')
my_data <- lapply(sp_p,fread)
setwd("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/prim_result")
sp_p <- list.files("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/prim_result", pattern='.csv')
my_data <- lapply(sp_p,fread)
loss <- sub('.csv',"",sp_p[lapply(my_data,nrow)<30])
write.csv(loss,"E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/loss_name.csv")
################ checking the loss name and completing the data
sp_n <- sub('.csv',"",sp_p)
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
View(bio_tol)
################ checking the loss name and completing the data
sp_n <- sub('.csv',"",sp_p)
for (i in 1:72){
my_data[[i]][,name:=sp_n[i]]
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
library(ggplot2)
#############################plot
a <- ggplot(data=bio_tol,ase(x=name,y=bio1))
#############################plot
a <- ggplot(data=bio_tol,aes(x=name,y=bio1))
a+geom_violin(scale='area')
#############################plot
a <- ggplot(data=bio_tol,aes(x=name,y=bio_1))
a+geom_violin(scale='area')
a+boxplot()
#############################plot
a <- ggplot(data=bio_tol,aes(x=name,y=bio_1))
a+boxplot()
a+boxplot(aes(x=name))
a+boxplot(aes(group=name))
for (i in 1:72){
my_data[[i]][,name:=sp_n[i]][,code:=paste0("sp.",i)]
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
#############################plot
a <- ggplot(data=bio_tol,aes(x=name,y=bio_1))
a+boxplot(aes(group=name))
#############################plot
a <- ggplot(data=bio_tol,aes(x=code,y=bio_1))
#############################plot
a <- ggplot(data=bio_tol,aes(x=code,y=bio_1))
+geom_violin(scale='area')
#############################plot
a <- ggplot(data=bio_tol,aes(x=code,y=bio_1))+geom_violin(scale='area')
a+boxplot(aes(group=name))
a+boxplot()
#############################plot
a <- ggplot(data=bio_tol,aes(x=code,y=bio_1))+boxplot()
View(bio_tol)
#############################plot
ggplot(data=bio_tol,aes(x=code,y=bio_1))+boxplot()
#############################plot
ggplot(data=bio_tol,aes(x=code,y=bio_1))+boxplot(bio_1~code)
#############################plot
ggplot(bio_tol,aes(x=code,y=bio_1))+boxplot()
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot()
class(bio_tol[code])
class(bio_tol[,code])
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot(bio_1~code)
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot(bio_1~code,data=bio_tol)
for (i in 1:72){
my_data[[i]][,name:=sp_n[i]][,code:=i]
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot(bio_1~code,data=bio_tol)
for (i in 1:72){
my_data[[i]][,name:=sp_n[i]][,code:=i]
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot(bio_1~code,data=bio_tol)
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot()
my_data[[i]][,name:=sp_n[i]][,code:=as.numeric(i)]
for (i in 1:72){
my_data[[i]][,name:=sp_n[i]][,code:=as.numeric(i)]
}
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
#############################plot
ggplot(bio_tol,aes(code,bio_1))+boxplot()
#############################plot
ggplot(bio_tol,aes(code,bio_1))+geom_boxplot()
my_data[[i]][,name:=sp_n[i]][,code:=as.numeric(i)]
bio <- NULL
bio_tol <- NULL
for (i in 1:72){
bio <- my_data[[i]]
bio_tol <- rbind(bio_tol,bio)
}
bio_tol <- bio_tol[bio_1!="NA"]
#############################plot
ggplot(bio_tol,aes(code,bio_1))+geom_boxplot()
#############################plot
ggplot(bio_tol,aes(factor(code),bio_1))+geom_boxplot()
#############################plot
ggplot(bio_tol,aes(factor(code),bio_2))+geom_boxplot()
#############################plot
ggplot(bio_tol,aes(factor(code),bio_12))+geom_boxplot()
library(rgbif)
library(data.table)
library(raster)
setwd("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch")
svpath <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch"
path <- 'E:/Climdata/Chelsa_current_2019'
clim_d_n <- list.files(path)
nlist <-read.csv("name_list.txt")
j=1
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
rast <- raster(paste0(path,'/',clim_d_n[i]))
path <- 'E:/Climdata/Chelsa_current_2019'
rast <- raster(paste0(path,'/',clim_d_n[i]))
paste0(path,'/',clim_d_n[i])
clim_d_n <- list.files(path)
rast <- raster(paste0(path,'/',clim_d_n[i]))
i=1
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
data$key
for (j in 1:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
data$key
if (nrow(data)==0){name <- paste0('NULL_',name)
break
}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude,key)]
x <- extract(rast,spot[,.(decimalLongitude,decimalLatitude)])
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
result <- cbind(data[,.(decimalLongitude,decimalLatitude,key)],result)
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
library(rgbif)
library(data.table)
library(raster)
setwd("E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch")
svpath <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch"
path <- 'E:/Climdata/Chelsa_current_2019'
clim_d_n <- list.files(path)
nlist <-read.csv("name_list.txt")
for (j in 1:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)
break
}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude,key)]
x <- extract(rast,spot[,.(decimalLongitude,decimalLatitude)])
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
result <- cbind(data[,.(decimalLongitude,decimalLatitude,key)],result)
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
#deal with the primary data
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude,key)]
data <- as.data.table(occ_search(scientificName = name)$data)
library(data.table)
library(ggplot2)
library(agricolae)
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
rdata <- fread(paste0(path,"species_climate.csv"))
r2 <- rdata[,names(rdata[,6:24]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
write.csv(fin_r,paste0(path,"WI_data_base.csv"))
######################################plot and group
fin_r <- fread(paste0(path,"WI_data_base.csv"))
library(data.table)
library(raster)
library(tictoc) # running time
library(parallel) #平行運算
library(ggplot2)
install.packages("rlang")
library(ggplot2)
library(agricolae)
install.packages("vctrs")
library(agricolae)
install.packages("vctrs")
library(agricolae)
library(ggplot2)
library(data.table)
library(raster)
library(tictoc) # running time
library(parallel) #平行運算
library(ggplot2)
library(agricolae)
######################################plot and group
fin_r <- fread(paste0(path,"WI_data_base.csv"))
tuk <- with(fin_r,Median.test(WI,code))
order <-cbind(tuk$groups,rownames(tuk$groups))
colnames(order)[3] <- "code"
order <- as.data.table(order)
order[,code:=as.character(code)]
fin_r[,code:=as.character(code)]
fin_r <- fin_r[order,on=.(code=code)]
ggplot(data=fin_r,aes(x=fct_reorder(code,desc(i.WI)),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
theme(legend.position = "none")
?reorder
ggplot(data=fin_r,aes(x=reorder(code,-i.WI)),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
theme(legend.position = "none")
ggplot(data=fin_r,aes(x=reorder(code,-i.WI),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
theme(legend.position = "none")
ggplot(data=fin_r,aes(x=reorder(code,-i.WI),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
theme(legend.position = "none")
ggplot(data=fin_r,aes(x=reorder(code,-i.WI),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
theme(legend.position = "none")+
geom_hline(yintercept=c(12,36,72,108,144,216), linetype="dashed", color = "gray51")
ggsave(paste0(path,"plot_result/bio_WI.jpeg"),width = 12,height = 5,dpi=600)
ggplot(data=fin_r,aes(x=reorder(code,-i.WI),y=WI,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x="code",y='Warmth Index')+
geom_hline(yintercept=c(12,36,72,108,144,216), linetype="dashed", color = "gray51")
ggsave(paste0(path,"plot_result/bio_WI.jpeg"),width = 12,height = 5,dpi=600)
ggsave(paste0(path,"plot_result/bio_WI.jpeg"),width = 12,height = 6,dpi=600)
###############calculate the quantile
fin_r[,quantile(WI),by=code]
###############calculate the quantile
q1 <- fin_r[,quantile(WI),by=code]
View(q1)
View(q1)
q1 <- q1[,q:=rep(1:5,time=73)]
View(q1)
q1 <- dcast(q1,code~q,value.var = "V1")
write.csv(q1,paste0(path,'species_WI_niche.csv'))
rdata <- fread("E:/忍者/GLORIA_個人處理/2019/2019資料輸入/資料分析/species_climate.csv")
library(data.table)
library(ggplot2)
library(agricolae)
path <- "E:/忍者/R-work/Git/R-work/GLORIA/GBIF_dataCatch/"
rdata <- fread("E:/忍者/GLORIA_個人處理/2019/2019資料輸入/資料分析/species_climate.csv")
r2 <- rdata[,names(rdata[,5:23]):=lapply(.SD,as.numeric),
.SDcols=patterns('bio')]
rloc <- r2[,.(bio_1,bio_6,bio_12,code,name)][,code:=as.factor(code)]
############################### multiple comparison of temp
aov1 <- aov(bio_1~code,data=rloc)
tuk <- with(rloc,Median.test(bio_6,code))
order_1 <-tuk$group
order_1 <- as.data.table(cbind(order_1,rownames(order_1),c(1:length(order_1[,1]))))
colnames(order_1)[3:4] <-c('code','order')
order_1 <- order_1[order(order)]
write.csv(order_1,paste0(path,'species_group_mintemp.csv'))
setkey(rloc,code)
setkey(order_1,code)
plot_b1 <- rloc[order_1]
plot_b1[,i.bio_1:=NULL]
plot_b1[,i.bio_6:=NULL]
plot_b1 <- plot_b1[order(order)]
ggplot(data=plot_b1,aes(x=as.factor(reorder(code,order)),y=bio_1/10,fill=groups))+
geom_boxplot(outlier.colour=NA)+
theme_classic()+
labs(x='Species code',y='AAT (°C)',fill = "group")+
theme(legend.position = "none")+
geom_hline(yintercept=c(5,8,11,17,23), linetype="dashed", color = "gray51")
