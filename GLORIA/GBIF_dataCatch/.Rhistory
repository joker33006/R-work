rD1 <- rsDriver(browser = "chrome", port = 4510L, geckover = NULL,
chromever =  "latest", iedrver = NULL,
phantomver = NULL, extraCapabilities = cprof)
driver <- rsDriver(port=4444L,browser="chrome")
driver <- rsDriver(port=4454L,browser="chrome")
remote_driver <- driver$client
remDr$open()
driver <- rsDriver(port=4454L,browser="chrome")
driver <- rsDriver(port=4464L,browser="chrome")
driver <- rsDriver(port=4464L,browser="chrome")
remote_driver <- driver$client
driver$open()
remote_driver <- driver$client
driver <- rsDriver(port=4466L,browser="chrome")
rD1 <- rsDriver(browser = "chrome", port = 4567L, geckover = NULL,
chromever =  "latest", iedrver = NULL,
phantomver = NULL, extraCapabilities = cprof)
rD1 <- rsDriver(browser = "chrome", port = 4555L, geckover = NULL,
chromever =  "latest", iedrver = NULL,
phantomver = NULL, extraCapabilities = cprof)
rD1 <- rsDriver(browser = "chrome", port = 4555L, geckover = NULL,
chromever =  "latest", iedrver = NULL,
phantomver = NULL, extraCapabilities = cprof)
rD1 <- rsDriver(browser = "chrome", port = 4551L, geckover = NULL,
chromever =  "latest", iedrver = NULL,
phantomver = NULL, extraCapabilities = cprof)
rD1 <- rsDriver(browser = "chrome", port = 4551L)
rD1 <- rsDriver(browser = "chrome", port = 4514L)
library(RSelenium)
rD1 <- rsDriver(browser = "chrome", port = 4514L)
binman::list_versions("chromedriver")
rD1 <- rsDriver(browser = "chrome", port = 4514L,chromever="81.0.4044.129")
rD1 <- rsDriver(browser = "chrome", port = 4514L)
rD1 <- rsDriver(browser = "chrome", port = 4516L)
rD1 <- rsDriver(browser = "chrome", port = 4516L)
library(RSelenium)
library(RSelenium)
rD1 <- rsDriver(browser = "chrome", port = 4516L)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://www.google.com.tw/")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=2072266814")
install.packages("seleniumPipes")
library(seleniumPipes)
name <- findElement(remDr,using=c(id="ContentPlaceHolder1_teams_name"))
name <- findElement(remDr,using=id,value="ContentPlaceHolder1_teams_name")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=2072266814")
name <- findElement(remDr,using=id,value="ContentPlaceHolder1_teams_name")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=2072266814")
name <- findElement(remDr,using=id,value="ContentPlaceHolder1_teams_name")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1.aspx")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1.aspx")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1488545234")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1488545234")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1488545234")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1488545234")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1488545234")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
clik <- findElement(remDr,using = "id", value="chk[]0")
View(r1)
remDr$navigate("https://npm.cpami.gov.tw/apply_1_3.aspx?RandomStr=1704798208")
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
clik <-  remDr$find_element_by_id(chk[]0)
clik <-  remDr$find_element_by_id("chk[]0")
library(seleniumPipes)
clik <-  remDr$find_element_by_id("chk[]0")
?find_element_by_id
??find_element_by_id
clik <- findElement(remDr = remDr,using = "input id",value = "chk[]0")
clik <- findElement(remDr = remDr,using = "id",value = "chk\[\]0")
clik <- findElement(remDr = remDr,using = "input id",value = "chk\[\]0")
clik <- remDr$findElement(using ='id',value = "chk\[\]0")
clik <- remDr$findElement(using ='id',value = "chk[]0")
clik$clickElement()
clik$clickElement()
clik <- remDr$findElement(using ='id',value = "chk[]9")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
clik <- remDr$findElement(using ='id',value = "chk[]0")
clik$clickElement()
clik2 <- remDr$findElement(using ='id',value = "chk[]9")
clik$clickElement()
clik$clickElement()
clik2$clickElement()
clik3 <- remDr$findElement(using ='id',value = "chk[]10")
clik3$clickElement()
n <- c("",0,9:12)
set_colnames()
n
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4445L,
browserName = "firefox")
remDr$open()
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4521,
browserName = "firefox")
remDr$open()
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4554L,
browserName = "firefox")
remDr$open()
remDr <- remoteDriver(
port = 4554L,
browserName = "firefox")
remDr$open()
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4441,
browserName = "firefox")
remDr$open()
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
n <- c("",0,9:12)
for (i in 1:length(n)){
clik <- remDr$findElement(using ='id',value = paste0("chk[]",n[i]))
clik$clickElement()
}
clik <- remDr$findElement(using ='id',value = "ContentPlaceHolder1_btnagree")
aggclick <- remDr$findElement(using ='id',value = "ContentPlaceHolder1_btnagree")
aggclick$clickElement()
aggclick$click()
aggclick <- remDr$findElement(using ='id',value = "ContentPlaceHolder1_btnagree")
aggclick$click()
aggclick$clickElement()
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444,
browserName = "firefox")
remDr$open()
remDr$navigate("https://npm.cpami.gov.tw/apply_1_2.aspx?unit=e6dd4652-2d37-4346-8f5d-6e538353e0c2")
n <- c("",0,9:12)
for (i in 1:length(n)){
click <- remDr$findElement(using ='id',value = paste0("chk[]",n[i]))
click$clickElement()
}
aggclick <- remDr$findElement(using ='id',value = "ContentPlaceHolder1_btnagree")
aggclick$clickElement()
team_Name <- remDr$findElement(using = "id",value ="ContentPlaceHolder1_teams_name")
team_Name$sendKeysToElement("中興森林",key="enter")
team_Name$sendKeysToElement(list("中興森林",key="enter"))
selt <- remDr$findElement(using = "id",value = "ContentPlaceHolder1_climblinemain")
selt[[4]]$clickElement()
selt[4]$clickElement()
selt
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="#ContentPlaceHolder1_climbline > option:nth-child(4)")
selt$clickElement()
selt2 <- remDr$findElement(using="css selector",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "xpath",value = "/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[1]/option[2]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
### main route 路線兩區必須要依序執行
selt <- remDr$findElement(using = "CSS select",value = #ContentPlaceHolder1_climbline > option:nth-child(4))
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
### second route
selt2 <- remDr$findElement(using="xpath",value ="/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[2]/div/select[2]/option[4]")
selt$clickElement()
selt2$clickElement()
### days
selt3 <- remDr$findElement(using="css selector",value =
"#ContentPlaceHolder1_sumday > option:nth-child(6)")
selt3$clickElement()
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/option value=109-05-30"
)
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/option")
selt3$opition
selt3$option
selt3$value
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/")
### date
selt4 <- remDr$findElement(using="xpath",value =
"/html/body/form/div[4]/div[3]/div[2]/div[2]/div/div[3]/div/div/div/div[1]/div/div/div/div[4]/div/select/")
### date
selt4 <- remDr$findElement(using="xpath",value =
"//*[@id='ContentPlaceHolder1_applystart']")
selt4$value
opts <- selt4$selectTag()
selt4$value
selt4$value$value
class(selt4$value$value)
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
remDr$open()
remDr$navigate("https://translate.google.com.tw/?hl=zh-TW")
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("我的頭好痛"))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(10)
}
cn$clearElement()
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.5)
}
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.5)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.1)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(0.2)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
cn$sendKeysToElement(list("有是嗎 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("蘇昱好帥 "))
for (i in 1:10){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(3)
}
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
library(RSelenium)
library(seleniumPipes)
remDr <- remoteDriver(
remoteServerAddr = "localhost",
port = 4444L,
browserName = "firefox")
remDr$open()
remDr$navigate("https://translate.google.com.tw/?hl=zh-TW")
cn <- remDr$findElement(using = "id",value = "source")
cn$clearElement()
cn$sendKeysToElement(list("方丈為人很小心眼的"))
for (i in 1:5){
cn <- remDr$findElement(using = "css selector",value = ".src-tts > div:nth-child(1)")
cn$clickElement()
Sys.sleep(10)
}
j=50
name <- as.character(nlist[j,1])
library(rgbif)
library(data.table)
library(raster)
setwd("E:/忍者/R-work/GLORIA/GBIF_dataCatch")
svpath <- "E:/忍者/R-work/GLORIA/GBIF_dataCatch"
path <- 'E:/Climdata/Chelsa_current_2019'
clim_d_n <- list.files(path)
nlist <-read.csv("name_list.txt")
name <- as.character(nlist[j,1])
name
i=1
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
is.null(data)
data
row(data)=0
row(data)
row(data)=0
if (row(data)==0){}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
row(data)==0
data[1]=0
data[1]==0
if (data[1]==0){}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
data
is.null(data)
nrow(data)==0
for (j in 50:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
setwd("E:/忍者/R-work/GLORIA/GBIF_dataCatch")
svpath <- "E:/忍者/R-work/GLORIA/GBIF_dataCatch"
path <- 'E:/Climdata/Chelsa_current_2019'
nlist <-read.csv("name_list.txt")
for (j in 50:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
for (j in 66:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)
break
}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
j=65
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)
break
}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
for (j in 67:length(nlist[,1])){
name <- as.character(nlist[j,1])
##### start extract the climate data
result <- NULL
for (i in 1:length(clim_d_n)){
rast <- raster(paste0(path,'/',clim_d_n[i]))
data <- as.data.table(occ_search(scientificName = name)$data)
if (nrow(data)==0){name <- paste0('NULL_',name)
break
}else{
spot <- data[decimalLatitude!="NA",.(decimalLongitude,decimalLatitude)]
x <- extract(rast,spot)
result <-cbind(result,x)
colnames(result)[i] <- paste0("bio_",i)
}
}
write.csv(result,paste0(svpath,"/prim_result/",name,".csv"))
cat(j)
}
