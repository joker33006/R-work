library(data.table)
library(ggplot2)
library(lme4)
library(broom)
path <- 'E:/忍者/GLORIA_個人處理/paper_準備/'
EVI <- fread(paste0(path,'EVI/EVI_ts_date_2003_2020.csv'))
weather <- fread('E:/忍者/GLORIA_個人處理/Weather_data/2009-2020_temp_month.csv')
weather <- fread('E:/忍者/GLORIA_個人處理/Weather_data/2009-2020_temp_month.csv')
colnames(EVI)
colnames(weather)
EVI_m <- EVI[,.(EVI=mean(EVI)),by=.(summit,month,year,Season)]
rd <- EVI_m[weather,on=.(year=year,month=month,summit=summit),all=F]
rd <- rd[year!=2020]
rd[month %in% 3:5,season:='Spring'][
month %in% 6:8,season:='Summer'][
month %in% 9:11,season:='Fall'][
is.na(season),season:='Winter']
rd_y <- rd[,.(EVI=mean(EVI),temp=mean(temp),rain=sum(rain)),by=.(year,summit)]
rd_s <- rd[,.(EVI=mean(EVI),temp=mean(temp),rain=sum(rain)),by=.(year,summit,season)]
s <- c('Spring','Summer','Fall','Winter')
r <- NULL
for (i in 1:4){
gm1 <- glmer(EVI~temp+log(rain)+temp+(1|summit),data=rd_s[season==s[i]],family = Gamma(link='log'))
Results <- capture.output(summary(gm1))
r <- rbind(r,cbind(s[i],Results[21:25]))
summary(gm1)
}
write.csv(r,paste0(path,"GLMM_seasonal_EVI_temp_lograin.csv"))
ggplot(rd_s[season=='Fall'],aes(x=temp,y=EVI,color=summit))+
geom_point()+
geom_smooth(method = "glm", formula =y~x)
summary(gm1)
glance(gm1)
r2(gm1)
install.packages("sjstats")
library(sjstats)
r2(gm1)
gm1 <- glmer(EVI~temp+rain+temp+(1|summit),data=rd_s[season==s[i]],family = Gamma(link='log'))
gm1 <- glmer(EVI~temp+log(rain)+temp+(1|summit),data=rd_s[season==s[i]],family = Gamma(link='log'))
Results <- capture.output(summary(gm1))
for (i in 1:4){
gm1 <- glmer(EVI~temp+log(rain)+temp+(1|summit),data=rd_s[season==s[i]],family = Gamma(link='log'))
Results <- capture.output(summary(gm1))
r <- rbind(r,cbind(s[i],Results[21:25]))
r2(gm1)
summary(gm1)
}
performance::r2(gm1)
